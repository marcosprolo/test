<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="favicon.ico">
    
    <title>STORE</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="styldsadaesh.css">

    <!-- Custom styles for this template -->
    <link href="shop-homepage.css" rel="stylesheet">

    <!-- Temporary navbar container fix -->
    <style>
    .navbar-toggler {
        z-index: 1;
    }
    
    @media (max-width: 576px) {
        nav > .container {
            width: 20%;
        }
    }
    /* Temporary fix for img-fluid sizing within the carousel */
    
    .carousel-item.active,
    .carousel-item-next,
    .carousel-item-prev {
        display: block;
    }

      body {
        padding-top: 50px;
        color: #868688;
        background-color: #FAFCFF;
      }
      nav {
        background-color: #e7e7e7
      }
      nav a {
        color: #868688;
      }
      nav a:hover {
        color: #606062;
        text-decoration: none;
      }
      .navbar-toggle .icon-bar {
        background-color: #868688;
      }
      .starter-template {
        padding: 40px 15px;
        text-align: center;
      }
      .video-js {
        margin: 0 auto;
      }
      input {
        margin-top: 15px;
        min-width: 450px;
        padding: 5px;
      }

      #next2{
        cursor: pointer;
        float: right;
      }
/*      p{
        /*width: 250px;*/
     /*white-space: nowrap;*/
     /*overflow: hidden;*/
     /*text-overflow: ellipsis;*/
      /*}*/
    </style>
    <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
    </style>
    <script src="dist/aws-cognito-sdk.min.js"></script>
    <script src="dist/amazon-cognito-identity.min.js"></script>
</head>

<body>
  <!-- modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">New message</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <label for="recipient-name" class="form-control-label">Contact Email:</label>
              <input type="text" class="form-control" id="recipient-email">
            </div>            
            <div class="form-group">
              <label for="recipient-name" class="form-control-label">Contact Name:</label>
              <input type="text" class="form-control" id="recipient-name">
            </div>
            <div class="form-group">
              <label for="message-text" class="form-control-label">Message:</label>
              <textarea class="form-control" id="message-text"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" onclick="send()" class="btn btn-primary">Send message</button>
        </div>
      </div>
    </div>
  </div>


<!-- end modal -->

  <!-- modal SignIn -->
    <div class="modal fade" id="signInModal" tabindex="-1" role="dialog" aria-labelledby="signInModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="signInModalLabel">Sign in</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <label for="sign-username" class="form-control-label">Username:</label>
              <input type="text" class="form-control" id="sign-username">
            </div>            
            <div class="form-group">
              <label for="sign-name" class="form-control-label">Nickname:</label>
              <input type="text" class="form-control" id="sign-name">
            </div>
            <div class="form-group">
              <label for="sign-name" class="form-control-label">Email:</label>
              <input type="text" class="form-control" id="sign-email">
            </div>             
            <div class="form-group">
              <label for="sign-password" class="form-control-label">Password:</label>
              <input type="text" class="form-control" id="sign-password">
            </div>            
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" onClick="register()" class="btn btn-primary">Sign in</button>
        </div>
      </div>
    </div>
  </div>
<!-- end modal -->  

<!-- modal logIn -->
    <div class="modal fade" id="logInModal" tabindex="-1" role="dialog" aria-labelledby="logInModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="logInModalLabel">Log in</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <label for="log-name" class="form-control-label">Username:</label>
              <input type="text" class="form-control" id="login-username">
            </div>             
            <div class="form-group">
              <label for="log-pass" class="form-control-label">Password:</label>
              <input type="text" class="form-control" id="login-password">
            </div>            
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" onClick="logIn()" class="btn btn-primary">Log in</button>
        </div>
      </div>
    </div>
  </div>
<!-- end modal -->
    <!-- Navigation -->
    <nav class="navbar fixed-top navbar-toggleable-md navbar-inverse bg-inverse">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarExample" aria-controls="navbarExample" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="container">
            <a class="navbar-brand" href="#">Product Store</a>
            <div class="collapse navbar-collapse" id="navbarExample">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="https://s3-us-west-2.amazonaws.com/demo.ecommerce2/page+v2/index.html">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="modal" data-target="#exampleModal" href="#">Contact</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="cart.html" target="_blank">Cart</a>
                    </li>                       
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-toggle="modal" data-target="#logInModal">Log in</a>
                    </li>                    
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-toggle="modal" data-target="#signInModal">Sign in</a>
                    </li>                    
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">

        <div class="row">

            <div class="col-lg-3">

                <h1 class="my-4">Categories</h1>
                <div class="list-group">
                    <a href="#" onClick="byCat('phone')" class="list-group-item">Phones</a>
                    <a href="#" onClick="byCat('notebook')" class="list-group-item">Laptops</a>
                    <a href="#" onClick="byCat('monitor')" class="list-group-item">Monitors</a>
                </div>
                <h1 class="my-4">About Us</h1>
                <div class="list-group">
                  <!-- <section class="starter-template"> -->
                    <video poster="imgs/front.jpg" id=example-video width=270 height=190 class="video-js" controls>
                    </video>
                  <!-- </section> -->
                </div>
            </div>
            <div class="col-lg-9">
                  <!-- <div class="container"> -->
                  <div id="carouselExampleIndicators" class="carousel slide my-4" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner" role="listbox">
                        <div class="carousel-item active">
                            <img class="d-block img-fluid" src="samsung1.jpg" alt="First slide">
                        </div>
                        <div class="carousel-item">
                            <img class="d-block img-fluid" src="nexus1.jpg" alt="Second slide">
                        </div>
                        <div class="carousel-item">
                            <img class="d-block img-fluid" src="iphone1.jpg" alt="Third slide">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
                <div class="row" id="tbodyid">
                </div>
                <form name="frm" id="frm" style="float: right;" onsubmit="return false">
        <button type="button" id="next2" class="btn btn-success">Next ></button>
        </form>
    </div>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="js/ie10-viewport-bug-workaround.js"></script>
    <link href="https://unpkg.com/video.js/dist/video-js.css" rel="stylesheet">
    <script src="https://unpkg.com/video.js/dist/video.js"></script>
    <script src="https://unpkg.com/videojs-contrib-hls/dist/videojs-contrib-hls.js"></script>
     <!-- <form name="frm" id="frm" style="float: right;" onsubmit="return false"> -->
    <!-- <button type="button"  class="btn btn-primary" id="next2" value="">Next</button> -->
<!-- </form> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script type="text/javascript">

    function guid() {
      function s4() {
        return Math.floor((1 + Math.random()) * 0x10000)
            .toString(16)
            .substring(1);
        }
      return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
        s4() + '-' + s4() + s4() + s4();
    }

    var API_URL = 'https://eytd7kn5ik.execute-api.us-west-2.amazonaws.com/prod/entries';
    $(document).ready(function(){
      document.cookie = "user=" + guid();
      $.ajax({
        type: 'GET',
        url: API_URL,
        success: function(data){
          // alert(JSON.stringify(data));
          var valew = JSON.parse(JSON.stringify(data));
          document.frm.next2.value = valew.LastEvaluatedKey["id"];
          data.Items.forEach(function(articleItem){
            $('#tbodyid').append('<div class="col-lg-4 col-md-6 mb-4">' + '<div class="card h-100">' + '<a href="#" onClick="showIt('+ articleItem.id +')">' + '<img class="card-img-top img-fluid" src="'+articleItem.img+'" alt="">'+ '</a>' + '<div class="card-block">' + '<h4 class="card-title">' + '<a href="#" onClick="showIt('+ articleItem.id +')">' + articleItem.title + '</a>' + '</h4>' + '<h5>' + articleItem.price + '</h5>' + '<p class="card-text">' + articleItem.desc + ' </p>' + ' </div>' + '</div>' +'</div>');
          })
        }
      });
    });

    $('#agregar').on('click', function(){
      $.ajax({
        type:'POST',
        url: API_URL,
        data: JSON.stringify({"id": $('#id').val(),"title": $('#title').val(),"price": $('#price').val()}),
        contentType: "application/json",

        success: function(data){
            location.reload();
        }
      });
      return false;
    });



    $('#next2').on('click', function(){
      $.ajax({
        type:'POST',
        url: 'https://eytd7kn5ik.execute-api.us-west-2.amazonaws.com/prod/pagination',
        data: JSON.stringify({"id": $('#next2').val()}),
        contentType: "application/json",

        success: function(data){
          var valew = JSON.parse(JSON.stringify(data));
          if (valew.ScannedCount == 9){
            document.frm.next2.value = valew.LastEvaluatedKey["id"];
          }else{
            div = document.getElementById('next2');
            div.style.display = 'none';
          }
            $('#tbodyid').empty();
          data.Items.forEach(function(articleItem){
            $('#tbodyid').append('<div class="col-lg-4 col-md-6 mb-4">' + '<div class="card h-100">' + '<a href="#">' + '<img class="card-img-top img-fluid" src="'+articleItem.img+'" alt="">'+ '</a>' + '<div class="card-block">' + '<h4 class="card-title">' + '<a href="#" onClick="showIt('+ articleItem.id +')">' + articleItem.title + '</a>' + '</h4>' + '<h5>' + articleItem.price + '</h5>' + '<p class="card-text">' + articleItem.desc + ' </p>' + ' </div>' + '</div>' +'</div>');
          })
        }
      });
      return false;
    }); 

    function showIt(eid){
      // location.href= 'prod.html?id=' + eid;
      window.open('prod.html?id=' + eid,'_blank');
    } 

    function send(){
      document.getElementById("recipient-email").value = "";
      document.getElementById("recipient-name").value = "";
      document.getElementById("message-text").value = "";
      alert('Thanks for the message!!');
      $('#exampleModal').modal('hide');
    }

    function byCat(cat){
      $.ajax({
        type:'GET',
        url: API_URL,
        success: function(data){
            $('#tbodyid').empty();
          var valew = JSON.parse(JSON.stringify(data));
          document.frm.next2.value = valew.LastEvaluatedKey["id"];
          data.Items.forEach(function(articleItem){
            if(articleItem.cat == cat){
                $('#tbodyid').append('<div class="col-lg-4 col-md-6 mb-4">' + '<div class="card h-100">' + '<a href="#" onClick="showIt('+ articleItem.id +')">' + '<img class="card-img-top img-fluid" src="'+articleItem.img+'" alt="">'+ '</a>' + '<div class="card-block">' + '<h4 class="card-title">' + '<a href="#" onClick="showIt('+ articleItem.id +')">' + articleItem.title + '</a>' + '</h4>' + '<h5>' + articleItem.price + '</h5>' + '<p class="card-text">' + articleItem.desc + ' </p>' + ' </div>' + '</div>' +'</div>');
            }
          })
        }
      });
    }
        
    $(document).ready(function(window, videojs){
        var player = window.player = videojs('example-video');
        var url = "https://s3.amazonaws.com/hls.demo.output/BM_training/index.m3u8";
          player.src({
            src: url,
            type: 'application/x-mpegURL'
          });
          return false;
    }(window, window.videojs));
    </script>

    <script>
    function logIn(){
        var password = document.getElementById("login-password").value;
        var username = document.getElementById("login-username").value;
        var authenticationData = {
            Username : username,
            Password : password,
        };
        var authenticationDetails = new AWSCognito.CognitoIdentityServiceProvider.AuthenticationDetails(authenticationData);
        var poolData = {
            UserPoolId : 'us-west-2_GW9FQ6y0H', // Your user pool id here
            ClientId : 'ji731td9dcmv4dopq60oin7vg' // Your client id here
        };
        var userPool = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(poolData);
        var userData = {
            Username : username,
            Pool : userPool
        };
        var cognitoUser = new AWSCognito.CognitoIdentityServiceProvider.CognitoUser(userData);
        cognitoUser.authenticateUser(authenticationDetails, {
            onSuccess: function (result) {
                console.log('access token + ' + result.getAccessToken().getJwtToken());

                AWS.config.credentials = new AWS.CognitoIdentityCredentials({
                    IdentityPoolId : 'us-west-2_GW9FQ6y0H', // your identity pool id here
                    Logins : {
                        // Change the key below according to the specific region your user pool is in.
                        'cognito-idp.<us-west-2>.amazonaws.com/<us-west-2_GW9FQ6y0H>' : result.getIdToken().getJwtToken()
                    }
                });

                // Instantiate aws sdk service objects now that the credentials have been updated.
                // example: var s3 = new AWS.S3();

            },

            onFailure: function(err) {
                alert(err);
            },

        });
    }


    function register(){
      // alert('llego');
        var poolData = {
            UserPoolId : 'us-west-2_GW9FQ6y0H', // Your user pool id here
            ClientId : 'ji731td9dcmv4dopq60oin7vg' // Your client id here
        };
        var userPool = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(poolData);
        var nick = document.getElementById("sign-name").value;
        var email = document.getElementById("sign-email").value;
        var password = document.getElementById("sign-password").value;
        var username = document.getElementById("sign-username").value;
        var attributeList = [];

        var dataEmail = {
            Name : 'email',
            Value : email
        };        

        var dataNickname = {
            Name : 'nickname',
            Value : nick
        };

        var attributeEmail = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserAttribute(dataEmail);
        var attributeNickname = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserAttribute(dataNickname);

        attributeList.push(attributeEmail);
        attributeList.push(attributeNickname);

        userPool.signUp(username, password, attributeList, null, function(err, result){
            if (err) {
                alert(err);
                return;
            }
            cognitoUser = result.user;
            console.log('user name is ' + cognitoUser.getUsername());

            var code = prompt("Please enter comfirmation code", "");
            
            if (code != null) {
              var poolData = {
                  UserPoolId : 'us-west-2_GW9FQ6y0H', // Your user pool id here
                  ClientId : 'ji731td9dcmv4dopq60oin7vg' // Your client id here
              };

              var userPool = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(poolData);
              var userData = {
                  Username : username,
                  Pool : userPool
              };

              var cognitoUser = new AWSCognito.CognitoIdentityServiceProvider.CognitoUser(userData);
              cognitoUser.confirmRegistration(code, true, function(err, result) {
                  if (err) {
                      alert(err);
                      return;
                  }
                  console.log('call result: ' + result);
                  document.getElementById("sign-name").value = "";
                  document.getElementById("sign-email").value = "";
                  document.getElementById("sign-password").value = "";
                  document.getElementById("sign-username").value = "";
                  $('#signInModal').modal('hide');
              });
            }
        });
    }

    </script>


    <!-- Footer -->
    <footer class="py-5 bg-inverse">
        <div class="container">
            <p class="m-0 text-center text-white">Copyright &copy; Product Store 2017</p>
        </div>
        <!-- /.container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/tether/tether.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

</body>

</html>
